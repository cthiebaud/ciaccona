<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Puzzle</title>

    <!-- bootstrap -->
    <link rel="stylesheet" href="/lib/bootstrap-5.2.3.min.css">
    <style>
        body {
            width: 100vw;
            height: 100vh;
        }

        #thePuzzle {
            width: 1200px;
            height: 630px;
            margin: auto;
            background-color: gray;
        }

        .ligne {
            width: 1200px;
            height: 105px;
        }

        .colonne {
            width: 200px;
            height: 105px;
            background-repeat: no-repeat;
            /* background-size: cover; */
        }
    </style>
</head>

<body>
    <div class="container-xxl">
        <div id="thePuzzle" class="d-flex flex-column">

        </div>
    </div>
    <script type="module">
        import { generateElement } from '/js/utils.js'
        import { loadArtists } from "/js/artists.js?v=0.11.1"
        import JigsawShield from '/js/jigsawShield.js?v=0.11.1'

        const bg = (a, v) => `url('artists/${a}/${a}-${v}.jpg')`

        const jigsawGenerator = new JigsawShield({
            xn: 9,
            yn: 4,
            width: 1200,
            height: 630,
        })

        const xn = 6, yn = 6;
        for (let yi = 0; yi < yn; yi++) {
            const row = generateElement(`<div id="row${yi}" class="ligne d-flex"></div>`)
            thePuzzle.append(row)
            for (let xi = 0; xi < xn; xi++) {
                const col = generateElement(`<div id="row${yi}col${xi}" class="colonne"></div>`)
                row.append(col)
            }
        }
        let i = 0
        loadArtists().then((artists) => {
            artists.artists.forEach(a => {
                let xi = i % xn
                let yi = Math.floor(i / xn)
                const id = `row${yi}col${xi}`
                const cell = document.getElementById(id)
                console.log(yi, xi, cell)
                if (i < 35) {
                    if ([0,1,1,2,3,5,8,13,21,34].includes(i+1)) {
                        cell.style.backgroundImage = `url(/artists/${a.fullnameNoSpaceLowercaseNoDiacritics}/${a.fullnameNoSpaceLowercaseNoDiacritics}-${i}.jpg)`
                        cell.style.backgroundSize = 'cover'
                    } else {
                        cell.style.backgroundImage = `url(/artists/moi/moi-${0}.jpg)`
                        cell.style.backgroundPosition = `${20*xi}% ${20*yi}%`}
                    }
                    i++
                })
        })
    </script>
</body>

</html>